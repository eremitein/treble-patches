From c3534859e8f4cff0a6e363b4900ae26ccf65dfd1 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Wed, 30 Sep 2020 01:18:23 -0400
Subject: [PATCH 18/57] Revert "FODCircleView: Change show/hide of pressed
 view"

This reverts commit dd783ec89b14bccb4be440f1995d36ff9f1b164f.
---
 .../android/systemui/biometrics/FODCircleView.java  | 13 +++----------
 1 file changed, 3 insertions(+), 10 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
index 274473f05aa..c72647b130c 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
@@ -121,8 +121,6 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
     private boolean mIsDreaming;
     private boolean mIsKeyguard;
     private boolean mIsCircleShowing;
-    private boolean mIsShowing;
-    private boolean mPressedViewDisplayed = false;
 
     private Handler mHandler;
 
@@ -588,8 +586,6 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
             return;
         }
 
-        mIsShowing = true;
-
         updatePosition();
 
         dispatchShow();
@@ -598,7 +594,6 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
     }
 
     public void hide() {
-        mIsShowing = false;
         Dependency.get(TunerService.class).removeTunable(this);
         setVisibility(View.GONE);
         hideCircle();
@@ -691,17 +686,15 @@ public class FODCircleView extends ImageView implements ConfigurationListener, T
             }
 
             mPressedParams.dimAmount = dimAmount / 255.0f;
-            if (!mPressedViewDisplayed && mIsShowing) {
-                mPressedViewDisplayed = true;
+            if (mPressedView.getParent() == null) {
                 mWindowManager.addView(mPressedView, mPressedParams);
-            } else if (mPressedViewDisplayed) {
+            } else {
                 mWindowManager.updateViewLayout(mPressedView, mPressedParams);
             }
         } else {
             mPressedParams.screenBrightness = 0.0f;
             mPressedParams.dimAmount = 0.0f;
-            if (mPressedViewDisplayed) {
-                mPressedViewDisplayed = false;
+            if (mPressedView.getParent() != null) {
                 mWindowManager.removeView(mPressedView);
             }
         }
-- 
2.17.1

