From aa97625280598fb606a260b3f85f49ec80b6617d Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Wed, 29 Jul 2020 06:32:38 +0300
Subject: [PATCH 001/113] Revert "FingerprintDialogView: Improve on fod
 devices"

This reverts commit 8333ba1b77dd60ba275a2dea8d2a3a688432e8b1.
---
 .../SystemUI/res/layout/biometric_dialog.xml  |  4 ++--
 packages/SystemUI/res/values/cr_dimens.xml    |  8 -------
 .../biometrics/FingerprintDialogView.java     | 22 -------------------
 3 files changed, 2 insertions(+), 32 deletions(-)

diff --git a/packages/SystemUI/res/layout/biometric_dialog.xml b/packages/SystemUI/res/layout/biometric_dialog.xml
index d2398ee6ae5..c560d7e8f12 100644
--- a/packages/SystemUI/res/layout/biometric_dialog.xml
+++ b/packages/SystemUI/res/layout/biometric_dialog.xml
@@ -115,8 +115,8 @@
                             android:layout_height="wrap_content"
                             android:layout_marginEnd="24dp"
                             android:layout_marginStart="24dp"
-                            android:paddingTop="@dimen/fp_dialog_error_padding_top"
-                            android:paddingBottom="@dimen/fp_dialog_error_padding_bottom"
+                            android:paddingTop="16dp"
+                            android:paddingBottom="24dp"
                             android:textSize="12sp"
                             android:gravity="center_horizontal"
                             android:accessibilityLiveRegion="polite"
diff --git a/packages/SystemUI/res/values/cr_dimens.xml b/packages/SystemUI/res/values/cr_dimens.xml
index f4e5239207a..4c027573940 100644
--- a/packages/SystemUI/res/values/cr_dimens.xml
+++ b/packages/SystemUI/res/values/cr_dimens.xml
@@ -120,14 +120,6 @@
     <dimen name="dismiss_all_button_margin_bottom">35dp</dimen>
     <dimen name="dismiss_all_fab_src_size">30dp</dimen>
 
-    <!-- Custom padding size on biometric dialog -->
-    <dimen name="fp_dialog_error_padding_top">16dp</dimen>
-    <dimen name="fp_dialog_error_padding_bottom">24dp</dimen>
-
-    <!-- Custom padding size on biometric dialog when fingerprint in display is active -->
-    <dimen name="fp_dialog_error_padding_top_fingerprint_in_display">@dimen/fp_dialog_error_padding_top</dimen>
-    <dimen name="fp_dialog_error_padding_bottom_fingerprint_in_display">72dp</dimen>
-
     <!-- Padding on the start of the quick statusbar (not top-most statusbar) -->
     <dimen name="qs_header_start_padding">@dimen/status_bar_padding_start</dimen>
 
diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FingerprintDialogView.java b/packages/SystemUI/src/com/android/systemui/biometrics/FingerprintDialogView.java
index 8c4951c7512..183933eb395 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FingerprintDialogView.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FingerprintDialogView.java
@@ -17,16 +17,12 @@
 package com.android.systemui.biometrics;
 
 import android.content.Context;
-import android.content.pm.PackageManager;
 import android.graphics.drawable.AnimatedVectorDrawable;
 import android.graphics.drawable.Drawable;
 import android.util.Log;
-import android.view.View;
 
 import com.android.systemui.R;
 
-import lineageos.app.LineageContextConstants;
-
 /**
  * This class loads the view for the system-provided dialog. The view consists of:
  * Application Icon, Title, Subtitle, Description, Biometric Icon, Error/Help message area,
@@ -35,19 +31,10 @@ import lineageos.app.LineageContextConstants;
 public class FingerprintDialogView extends BiometricDialogView {
 
     private static final String TAG = "FingerprintDialogView";
-    private final boolean mHasFodSupport;
 
     public FingerprintDialogView(Context context,
             DialogViewCallback callback) {
         super(context, callback);
-        PackageManager packageManager = context.getPackageManager();
-        mHasFodSupport = packageManager.hasSystemFeature(LineageContextConstants.Features.FOD);
-        if (mHasFodSupport){
-            int paddingTop = getResources().getDimensionPixelSize(R.dimen.fp_dialog_error_padding_top_fingerprint_in_display);
-            int paddingBottom = getResources().getDimensionPixelSize(R.dimen.fp_dialog_error_padding_bottom_fingerprint_in_display);
-            mErrorText.setPadding(0, paddingTop, 0, paddingBottom);
-            mBiometricIcon.setVisibility(View.GONE);
-        }
     }
 
     @Override
@@ -74,9 +61,6 @@ public class FingerprintDialogView extends BiometricDialogView {
 
     @Override
     protected void updateIcon(int lastState, int newState) {
-        if (mHasFodSupport){
-            return;
-        }
         final Drawable icon = getAnimationForTransition(lastState, newState);
         if (icon == null) {
             Log.e(TAG, "Animation not found, " + lastState + " -> " + newState);
@@ -96,9 +80,6 @@ public class FingerprintDialogView extends BiometricDialogView {
     }
 
     protected boolean shouldAnimateForTransition(int oldState, int newState) {
-        if (mHasFodSupport){
-            return false;
-        }
         if (newState == STATE_ERROR) {
             return true;
         } else if (oldState == STATE_ERROR && newState == STATE_AUTHENTICATING) {
@@ -127,9 +108,6 @@ public class FingerprintDialogView extends BiometricDialogView {
     }
 
     protected Drawable getAnimationForTransition(int oldState, int newState) {
-        if (mHasFodSupport){
-            return null;
-        }
         int iconRes;
         if (newState == STATE_ERROR) {
             iconRes = R.drawable.fingerprint_dialog_fp_to_error;
-- 
2.25.1

